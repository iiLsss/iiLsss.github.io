<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-network/dns">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">DNS | 拯救de地球人</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://iilsss.github.io//docs/network/dns"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DNS | 拯救de地球人"><meta data-rh="true" name="description" content="DNS，Domain Name System，域名系统，其主要任务是进行从主机名到 IP 地址的转换。用户很难记住 IP 地址，于是便于用户记忆的主机名字代替 IP 地址。DNS 能够把互联网上的主机名字转换成 IP 地址。"><meta data-rh="true" property="og:description" content="DNS，Domain Name System，域名系统，其主要任务是进行从主机名到 IP 地址的转换。用户很难记住 IP 地址，于是便于用户记忆的主机名字代替 IP 地址。DNS 能够把互联网上的主机名字转换成 IP 地址。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://iilsss.github.io//docs/network/dns"><link data-rh="true" rel="alternate" href="https://iilsss.github.io//docs/network/dns" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://iilsss.github.io//docs/network/dns" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="拯救de地球人 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="拯救de地球人 Atom Feed"><link rel="stylesheet" href="/assets/css/styles.28aaf335.css">
<link rel="preload" href="/assets/js/runtime~main.7a681e47.js" as="script">
<link rel="preload" href="/assets/js/main.5eec9ff1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><b class="navbar__title text--truncate">地球</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro/">Note</a><a class="navbar__item navbar__link header-react-link" href="/docs/react/">React</a><a class="navbar__item navbar__link" href="/blog">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">More</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/interview/">📙 面试</a></li><li><a class="dropdown__link" href="/tool">🛠️ 工具</a></li></ul></div><a href="https://github.com/iiLsss/iiLsss.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro/">👋 Welcome!</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/network">计算机网络</a><button aria-label="打开/收起侧边栏菜单「计算机网络」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/network/tcp">TCP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/network/http">HTTP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/network/dns">DNS</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/js">Javascript</a><button aria-label="打开/收起侧边栏菜单「Javascript」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/algorithm">数据结构与算法</a><button aria-label="打开/收起侧边栏菜单「数据结构与算法」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/media">音视频</a><button aria-label="打开/收起侧边栏菜单「音视频」" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>DNS</h1><p>DNS，Domain Name System，域名系统，其主要任务是进行从主机名到 IP 地址的转换。用户很难记住 IP 地址，于是便于用户记忆的主机名字代替 IP 地址。DNS 能够把互联网上的主机名字转换成 IP 地址。</p><p>DNS 被设计成为一个联机<strong>分布式</strong>数据库系统</p><p>DNS 通过<strong> UDP 协议</strong>将用户数据报发给本地域名服务器(使用 UDP 为了减少开续)</p><p><img loading="lazy" src="/assets/images/dns-954760b2f4494498d854557a033701f9.png" width="981" height="612" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="域名结构">域名结构<a class="hash-link" href="#域名结构" title="标题的直接链接">​</a></h2><p>任何联机在互联网上的主机或路由器，都有一个唯一的层次结构名字，<strong>域名</strong>(domain name)</p><p><img loading="lazy" src="/assets/images/dns-yuming-cengtji-a1a0e59365e223856b5ed1bffd0ec131.png" width="952" height="423" class="img_ev3q"></p><p>DNS 域名服务器按照层次安排。每一个域名服务只对域名体系下的一部分进行管辖。根据域名服务器所起的作用，可以把域名划分四种不同的类型：</p><ul><li>根域名服务器：根域名服务器是最高层次的域名服务器。如果本地域名服务器无法解析域名，就首先求助于根服务器</li><li>顶级域名服务器：负责管理在该顶级域名服务器注册的所有二级域名</li><li>权限域名服务器：保存该区中的所有主机的域名到 IP 地址的映射</li><li>本地域名服务器：当一个主机发起 DNS 查询请求，首先发给本地域名服务器</li></ul><p><img loading="lazy" src="/assets/images/dns-yuming-ee820592953991651f6ecde6e5632e3a.png" width="1077" height="465" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="解析过程">解析过程<a class="hash-link" href="#解析过程" title="标题的直接链接">​</a></h2><ol><li><p>本地电脑会检查浏览器缓存中有没有这个域名对应的解析过的 IP 地址，如果缓存中有，这个解析过程就结束。浏览器缓存域名也是有限制的，不仅浏览器缓存大小有限制，而且缓存的时间也有限制，通常情况下为几分钟到几小时不等，域名被缓存的时间限制可以通过 TTL 属性来设置。这个缓存时间太长和太短都不太好，如果时间太长，一旦域名被解析到的 IP 有变化，会导致被客户端缓存的域名无法解析到变化后的 IP 地址，以致该域名不能正常解析，这段时间内有一部分用户无法访问网站。如果设置时间太短，会导致用户每次访问网站都要重新解析一次域名。</p></li><li><p>如果浏览器中没有数据，浏览器会查找操作系统缓存中是否有这个域名对应的 DNS 解析结果。其实操作系统也有一个域名解析的过程，在 Linux 中可以通过<code>/etc/hosts</code>文件来设置，而在 window 中可以通过<code>C:\\Windows\System32\drivers\etc\hosts</code>文件来设置，用户可以将任何域名解析到任何能够访问的 IP 地址。例如，我们在测试时可以将一个域名解析到一个测试服务器上，这样不用修改任务代码就能测试到单独服务器上的代码业务逻辑是否正确。正式因为有这种本地 DNS 解析的过程，所以有黑客就可能通过修改用户的域名来把特定域名解析到他指定的 IP 地址上，导致这些域名被劫持。</p></li><li><p>前两个过程无法解析时，就要用到我们网络设置中的 DNS 服务器地址。操作系统会把这个域名发给本地域名服务器。每个完整的内网通常都会配置本地域名服务器，例如用户是学校或者工作单位接入互联网，那么用户的本地域名服务器肯定在学校或工作单位里面。他们一般会缓存域名解析结果。</p></li><li><p>如果本地域名服务器没有命中，就直接到根域名服务器请求解析。</p></li><li><p>根域名服务器返回给本地域名服务器一个顶级域名服务器地址。它是国际顶级域名服务器，如<code>.com/.cn/.org</code>等，</p></li><li><p>本地 域名服务器再向上一步获得顶级服务器发送的解析请求</p></li><li><p>接受请求的顶级域名服务器查找并返回此域名对应的权限域名服务器的地址，这个权限域名服务器就是要访问网站域名提供商的服务器，其实该域名的解析任务就是由域名提供商的服务器来完成的。比如要访问<code>www.baidu.com</code>，而这个域名是从 A 公司注册获得的，那么 A 公司上的服务器就会有<code>www.baidu.com</code>的相关信息</p></li><li><p>区域服务器会查询存储的域名和 IP 的映射关系表，在把查询出来的域名和 IP 地址等信息，连同一个 TTL 值返回给本地域名服务器</p></li><li><p>返回该域名对应的 IP 和 TTL 值，本地域名服务器会缓存这个域名和 IP 的对应关系，缓存时间由 TTL 值控制</p></li><li><p>把解析的结果返回给本地电脑，本地电脑根据 TTL 值缓存在本地系统缓存中，域名解析过程结束在实际的 DNS 解析过程中，可能还不止这 10 步，如 权限域名服务器可能有很多级，或者有一个 GTM 来负载均衡控制，这都有可能会影响域名解析过程。</p></li></ol><p><img loading="lazy" src="/assets/images/dns-chanxun-825c6bbfba699444b13e61cb2a9e54c4.png" width="1464" height="1044" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="递归查询">递归查询<a class="hash-link" href="#递归查询" title="标题的直接链接">​</a></h3><p>主机像本地域名服务器的查询一般采用<strong>递归查询</strong>。所谓递归查询就是：如果主机所询问的本地域名服务器不知道被查询域名的 IP 地址，那么本地域名服务器就以 DNS 客户的身份，向其根域名服务器继续发出查询请求报文(即该该主机继续查询)，而不是让该主机自己进行下一步的查询。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="迭代查询">迭代查询<a class="hash-link" href="#迭代查询" title="标题的直接链接">​</a></h3><p>本地域名服务区向根域名服务器的查询通常是采用<strong>迭代查询</strong>。当根域名服务器收到本地域名服务器发出的迭代查询请求报文时，要么给出所要查询的 IP 地址，要么告诉本地域名服务器：“你下一步应当向那个域名服务器进行查询”。然后让本地域名服务器继续后续的查询（而不是替本地域名服务器进行后续的查询）。根域名服务器通常是把自己知道的顶级域名服务器的 IP 地址告诉本地域名服务器，让本地域名服务器再向顶级域名服务器查询。顶级域名服务器在收到本地域名服务器的查询请求后，要么给出索要查询的 IP 地址，要么告诉本地域名服务器下一步应当向哪一个权限域名服务器进行查询，本地域名服务器就这样进行迭代查询。最后，知道了所要解析的域名的 IP 地址，然后把这个结果返给发起查询的主机。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>区别</div><div class="admonitionContent_S0QG"><p>递归查询：客户端-本地域名服务器，返回的结果：查询成功或查询失败<br>
<!-- -->迭代查询：本地域名服务器-其他域名服务器，返回的结果：最佳的查询点或主机地址  </p></div></div><p><img loading="lazy" src="/assets/images/dns-chaxun-type-5caf8ac5c7a704552a6a578f6dd5017a.png" width="1039" height="652" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="缓存">缓存<a class="hash-link" href="#缓存" title="标题的直接链接">​</a></h3><p>为了提高 DNS 查询效率，并减轻根域名服务器的负荷和减少互联网上的 DNS 查询报文数量，在域名服务器中广泛使用了<strong>高速缓存</strong>(有时已成为高速缓存域名服务器)。高速缓存用来存放最近查询过的域名以及从何处获得域名映射信息的记录</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a class="hash-link" href="#总结" title="标题的直接链接">​</a></h2><ul><li>DNS 分布式数据库系统</li><li>使用 UDP 协议</li><li>客户端到本地域名服务器递归查询</li><li>域名服务器之间迭代查询</li><li>DNS 域名解析过程：浏览器缓存-&gt;系统 hosts 文件-&gt;本地 DNS 解析器缓存-&gt;本地域名服务器-&gt;根域名服务器-&gt;顶级域名服务器-&gt;权限域名服务器-&gt;本地域名服务器</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="参考资料">参考资料<a class="hash-link" href="#参考资料" title="标题的直接链接">​</a></h4><ol><li><a href="https://www.cnblogs.com/crazymakercircle/p/14976612.html#autoid-h2-5-0-0" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/crazymakercircle/p/14976612.html#autoid-h2-5-0-0</a></li><li><a href="https://blog.csdn.net/bangshao1989/article/details/121913780" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/bangshao1989/article/details/121913780</a></li><li>计算机网络(第 7 版)</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/计算机网络">计算机网络</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/dns">DNS</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/network/http"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">HTTP</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/js"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Javascript</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#域名结构" class="table-of-contents__link toc-highlight">域名结构</a></li><li><a href="#解析过程" class="table-of-contents__link toc-highlight">解析过程</a><ul><li><a href="#递归查询" class="table-of-contents__link toc-highlight">递归查询</a></li><li><a href="#迭代查询" class="table-of-contents__link toc-highlight">迭代查询</a></li><li><a href="#缓存" class="table-of-contents__link toc-highlight">缓存</a></li></ul></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/iiLsss/iiLsss.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 地球, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7a681e47.js"></script>
<script src="/assets/js/main.5eec9ff1.js"></script>
</body>
</html>